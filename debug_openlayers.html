<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OpenLayers Test Page</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ol@v8.2.0/ol.css" type="text/css">
    <script src="https://cdn.jsdelivr.net/npm/ol@v8.2.0/dist/ol.js"></script>
    <style>
        body { font-family: Arial, sans-serif; margin: 10px; }
        #map { width: 100%; height: 600px; border: 2px solid #ddd; }
        .info { background: #f5f5f5; padding: 10px; margin-bottom: 10px; }
    </style>
</head>
<body>
    <div class="info">
        <h2>🗺️ OpenLayers動作テスト</h2>
        <p>このページでOpenLayersライブラリが正常に動作するかテストします。</p>
    </div>
    
    <div id="map"></div>
    
    <script>
        try {
            console.log('OpenLayers version:', ol.VERSION_);
            
            // 日本の中心付近の座標（東京）
            const map = new ol.Map({
                target: 'map',
                layers: [
                    new ol.layer.Tile({
                        source: new ol.source.OSM()
                    })
                ],
                view: new ol.View({
                    center: ol.proj.fromLonLat([139.6917, 35.6895]), // 東京
                    zoom: 10
                })
            });
            
            // マーカーを追加
            const marker = new ol.Feature({
                geometry: new ol.geom.Point(ol.proj.fromLonLat([139.6917, 35.6895]))
            });
            
            marker.setStyle(new ol.style.Style({
                image: new ol.style.Circle({
                    radius: 8,
                    fill: new ol.style.Fill({color: 'red'}),
                    stroke: new ol.style.Stroke({color: 'white', width: 2})
                })
            }));
            
            const vectorSource = new ol.source.Vector({
                features: [marker]
            });
            
            const vectorLayer = new ol.layer.Vector({
                source: vectorSource
            });
            
            map.addLayer(vectorLayer);
            
            console.log('✅ OpenLayers map initialized successfully');
            
            // クリックイベント
            map.on('click', function(event) {
                const coordinate = ol.proj.toLonLat(event.coordinate);
                alert('クリック位置: ' + coordinate[1].toFixed(6) + ', ' + coordinate[0].toFixed(6));
            });
            
        } catch (error) {
            console.error('❌ OpenLayers initialization error:', error);
            document.getElementById('map').innerHTML = '<div style="color: red; padding: 20px;">OpenLayersの初期化に失敗しました: ' + error.message + '</div>';
        }
    </script>
</body>
</html>