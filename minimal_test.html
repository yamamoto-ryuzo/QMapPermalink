<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>OpenLayers æœ€å°ãƒ†ã‚¹ãƒˆ</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ol@v8.2.0/ol.css">
    <script src="https://cdn.jsdelivr.net/npm/ol@v8.2.0/dist/ol.js"></script>
    <style>
        body { margin: 0; padding: 10px; font-family: Arial, sans-serif; }
        #map { width: 100%; height: 600px; border: 2px solid red; }
        .debug { background: yellow; padding: 10px; margin: 10px 0; }
    </style>
</head>
<body>
    <div class="debug">
        <h2>ğŸ§ª OpenLayers æœ€å°å‹•ä½œãƒ†ã‚¹ãƒˆ</h2>
        <p>OpenLayersãƒãƒ¼ã‚¸ãƒ§ãƒ³: <span id="ol-version">èª­ã¿è¾¼ã¿ä¸­...</span></p>
        <p>ãƒãƒƒãƒ—çŠ¶æ…‹: <span id="map-status">åˆæœŸåŒ–ä¸­...</span></p>
    </div>
    
    <div id="map"></div>
    
    <script>
        console.log('ğŸš€ OpenLayersæœ€å°ãƒ†ã‚¹ãƒˆé–‹å§‹');
        
        // OpenLayersãƒãƒ¼ã‚¸ãƒ§ãƒ³è¡¨ç¤º
        document.getElementById('ol-version').textContent = ol.VERSION_ || 'unknown';
        
        try {
            // æ—¥æœ¬ã®åº§æ¨™ï¼ˆæ±äº¬é§…ï¼‰
            const tokyo = [139.7671, 35.6812];
            
            console.log('ğŸ“ ä½¿ç”¨åº§æ¨™:', tokyo);
            
            const map = new ol.Map({
                target: 'map',
                layers: [
                    new ol.layer.Tile({
                        source: new ol.source.OSM()
                    })
                ],
                view: new ol.View({
                    center: ol.proj.fromLonLat(tokyo),
                    zoom: 12
                })
            });
            
            // ãƒãƒ¼ã‚«ãƒ¼è¿½åŠ 
            const marker = new ol.Feature({
                geometry: new ol.geom.Point(ol.proj.fromLonLat(tokyo))
            });
            
            marker.setStyle(new ol.style.Style({
                image: new ol.style.Circle({
                    radius: 10,
                    fill: new ol.style.Fill({color: 'red'}),
                    stroke: new ol.style.Stroke({color: 'white', width: 2})
                }),
                text: new ol.style.Text({
                    text: 'æ±äº¬é§…',
                    font: '14px Arial',
                    fill: new ol.style.Fill({color: 'black'}),
                    offsetY: -20
                })
            }));
            
            const vectorLayer = new ol.layer.Vector({
                source: new ol.source.Vector({
                    features: [marker]
                })
            });
            
            map.addLayer(vectorLayer);
            
            document.getElementById('map-status').textContent = 'âœ… åˆæœŸåŒ–æˆåŠŸ';
            document.getElementById('map-status').style.color = 'green';
            
            console.log('âœ… OpenLayersãƒãƒƒãƒ—åˆæœŸåŒ–æˆåŠŸ');
            
            // ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆ
            map.on('click', function(evt) {
                const coord = ol.proj.toLonLat(evt.coordinate);
                console.log('ğŸ–±ï¸ ã‚¯ãƒªãƒƒã‚¯åº§æ¨™:', coord);
                alert('ã‚¯ãƒªãƒƒã‚¯ä½ç½®: ' + coord[1].toFixed(6) + ', ' + coord[0].toFixed(6));
            });
            
        } catch (error) {
            console.error('âŒ ãƒãƒƒãƒ—åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:', error);
            document.getElementById('map-status').textContent = 'âŒ ã‚¨ãƒ©ãƒ¼: ' + error.message;
            document.getElementById('map-status').style.color = 'red';
            document.getElementById('map').innerHTML = '<div style="color: red; padding: 20px; text-align: center;">ãƒãƒƒãƒ—åˆæœŸåŒ–ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message + '</div>';
        }
    </script>
</body>
</html>