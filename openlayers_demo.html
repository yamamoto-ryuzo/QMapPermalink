<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="utf-8">
    <title>QMap Permalink - Interactive Map Demo</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ol@8.2.0/ol.css" type="text/css">
    <script src="https://cdn.jsdelivr.net/npm/ol@8.2.0/dist/ol.js"></script>
    <style>
        body { font-family: Arial, sans-serif; margin: 10px; }
        #map { width: 100%; height: 400px; border: 2px solid #ddd; border-radius: 8px; margin: 10px 0; }
        .info-section { margin: 15px 0; padding: 15px; background: #f8f9fa; border-radius: 5px; }
        .link-section { margin: 15px 0; padding: 10px; border: 1px solid #ddd; border-radius: 5px; }
        .link-title { font-weight: bold; color: #333; margin-bottom: 5px; }
        .map-title { font-weight: bold; color: #2c5aa0; margin-bottom: 10px; font-size: 18px; }
        a { color: #1a73e8; text-decoration: none; word-break: break-all; }
        a:hover { text-decoration: underline; }
        .coordinates { font-family: monospace; background: #e9ecef; padding: 5px; border-radius: 3px; }
    </style>
</head>
<body>
    <h2>🗺️ QMap Permalink - Interactive Map View Demo</h2>
    
    <div class="info-section">
        <div class="map-title">📍 QGISマップビュー再現デモ</div>
        <p>QGISの現在の地図表示をOpenLayersで再現しています。同じ位置・ズームレベルで表示されます。</p>
    </div>

    <div class="info-section">
        <div class="coordinates">
            <strong>座標:</strong> 35.681236, 139.767125 | 
            <strong>ズーム:</strong> 17 | 
            <strong>スケール:</strong> 1:5,000 | 
            <strong>座標系:</strong> EPSG:4326
        </div>
    </div>

    <div id="map"></div>

    <script>
        // OpenLayersマップの初期化
        const map = new ol.Map({
            target: 'map',
            layers: [
                // OpenStreetMap ベースレイヤー
                new ol.layer.Tile({
                    source: new ol.source.OSM()
                }),
                // 地理院地図（日本の詳細地図）
                new ol.layer.Tile({
                    source: new ol.source.XYZ({
                        url: 'https://cyberjapandata.gsi.go.jp/xyz/std/{z}/{x}/{y}.png',
                        attributions: '&copy; <a href="https://maps.gsi.go.jp/development/ichiran.html">国土地理院</a>',
                        maxZoom: 18
                    }),
                    opacity: 0.7
                })
            ],
            view: new ol.View({
                center: ol.proj.fromLonLat([139.767125, 35.681236]), // 東京駅周辺
                zoom: 17
            })
        });

        // 中心点にマーカーを追加
        const marker = new ol.Feature({
            geometry: new ol.geom.Point(ol.proj.fromLonLat([139.767125, 35.681236]))
        });

        const markerStyle = new ol.style.Style({
            image: new ol.style.Circle({
                radius: 8,
                fill: new ol.style.Fill({color: '#ff4444'}),
                stroke: new ol.style.Stroke({color: '#ffffff', width: 2})
            })
        });

        marker.setStyle(markerStyle);

        const markerLayer = new ol.layer.Vector({
            source: new ol.source.Vector({
                features: [marker]
            })
        });

        map.addLayer(markerLayer);

        // クリックイベントで座標を表示
        map.on('click', function(event) {
            const coordinate = ol.proj.toLonLat(event.coordinate);
            alert('クリック位置: ' + coordinate[1].toFixed(6) + ', ' + coordinate[0].toFixed(6));
        });

        console.log('QMap Permalink OpenLayers Map Demo initialized');
    </script>

    <div class="info-section">
        <div class="map-title">🔗 外部マップサービス</div>
        <p>同じ位置を他のマップサービスでも確認できます：</p>
        
        <div class="link-section">
            <div class="link-title">🗺️ Google Maps で表示</div>
            <a href="https://www.google.co.jp/maps/@35.681236,139.767125,17z" target="_blank" rel="noopener noreferrer">https://www.google.co.jp/maps/@35.681236,139.767125,17z</a>
        </div>
        
        <div class="link-section">
            <div class="link-title">🌍 Google Earth で表示</div>
            <a href="https://earth.google.com/web/@35.681236,139.767125,610a,35y,0h,0t,0r" target="_blank" rel="noopener noreferrer">https://earth.google.com/web/@35.681236,139.767125,610a,35y,0h,0t,0r</a>
        </div>
    </div>

    <hr>
    <div class="info-section">
        <p><strong>📡 QMap Permalink v1.7.0 - OpenLayers Integration Demo</strong></p>
        <p>このインタラクティブマップはQGISプラグイン「QMap Permalink」によって生成されました。</p>
        <p>マップをクリックして座標を確認したり、ズーム・パンで周辺を探索できます。</p>
        <ul>
            <li><strong>赤いマーカー:</strong> QGISで指定された中心点</li>
            <li><strong>地理院地図:</strong> 日本の詳細な地形図を表示</li>
            <li><strong>インタラクティブ操作:</strong> ズーム・パン・クリック座標取得が可能</li>
        </ul>
    </div>
</body>
</html>